# Type: cicd
# Subtype: Cx
# English Summary: Modified build and deploy scripts
# Chinese Summary: 修改build和deploy脚本
# Entry Number: 4

# === Git Diff Content ===

diff --git a/Jenkinsfile b/Jenkinsfile
index 227a8da..f6f6873 100644
--- a/Jenkinsfile
+++ b/Jenkinsfile
@@ -3,7 +3,7 @@ pipeline {
     stages {
         stage('Build') {
             steps {
-                sh 'make build'
+                sh 'make compile'
             }
         }
         stage('Test'){
@@ -13,8 +13,10 @@ pipeline {
             }
         }
         stage('Deploy'){
-            when { branch 'master' }
+            when { branch 'production' }
             steps {
-                sh 'make deploy'
+                sh 'make package'
+                sh 'scp package.tar.gz user@deploy.server:/opt/deployments/'
+                sh 'ssh user@deploy.server "cd /opt/deployments/ && tar xzf package.tar.gz && rm package.tar.gz"'
             }
         }
     }