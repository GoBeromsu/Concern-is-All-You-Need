# Type: fix
# Subtype: I11
# English Summary: Update handleCount variable using synchronization block
# Chinese Summary: 使用同步块来更新 handleCount 变量
# Entry Number: 28

# === Git Diff Content ===

diff --git a/languagetool-server/src/main/java/org/languagetool/server/LanguageToolHttpHandler.java b/languagetool-server/src/main/java/org/languagetool/server/LanguageToolHttpHandler.java
index 56512723a9..01dddcbcfe 100644
--- a/languagetool-server/src/main/java/org/languagetool/server/LanguageToolHttpHandler.java
+++ b/languagetool-server/src/main/java/org/languagetool/server/LanguageToolHttpHandler.java
@@ -101,7 +101,9 @@ class LanguageToolHttpHandler implements HttpHandler {
 
   @Override
   public void handle(HttpExchange httpExchange) throws IOException {
-    handleCount++;
+    synchronized (this) {
+      handleCount++;
+    }
     String text = null;
     try {
       final URI requestedUri = httpExchange.getRequestURI();
@@ -145,7 +147,9 @@ class LanguageToolHttpHandler implements HttpHandler {
       final String response = "Error: " + StringTools.escapeXML(Tools.getFullStackTrace(e));
       sendError(httpExchange, HttpURLConnection.HTTP_INTERNAL_ERROR, response);
     } finally {
-      handleCount--;
+      synchronized (this) {
+        handleCount--;
+      }
       httpExchange.close();
     }
   }
